# ì˜í–¥ë„ ë¶„ì„ ê¸°ëŠ¥ ì¶”ê°€ êµ¬í˜„ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-10-21
**ìƒíƒœ**: êµ¬í˜„ ì™„ë£Œ (Phase 1 & Phase 2)
**ê´€ë ¨ ê³„íšì„œ**: [ì˜í–¥ë„ë¶„ì„ê¸°ëŠ¥ì¶”ê°€_ê³„íš(20251020).md](./ì˜í–¥ë„ë¶„ì„ê¸°ëŠ¥ì¶”ê°€_ê³„íš(20251020).md)

---

## 1. êµ¬í˜„ ê°œìš”

### 1.1 êµ¬í˜„ ë²”ìœ„
- âœ… **Phase 1**: í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„
  - ë°ì´í„° ëª¨ë¸ ì •ì˜
  - ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„ ë¡œì§
  - CLI ëª…ë ¹ì–´ ì¶”ê°€
- âœ… **Phase 2**: ë¦¬í¬íŠ¸ ìƒì„±
  - Markdown ë¦¬í¬íŠ¸
  - Excel ë¦¬í¬íŠ¸ (ë‹¤ì¤‘ ì‹œíŠ¸)
  - JSON ë¦¬í¬íŠ¸

### 1.2 êµ¬í˜„ ì¼ì
- **2025-10-21**: Phase 1 & Phase 2 êµ¬í˜„ ì™„ë£Œ

---

## 2. êµ¬í˜„ ìƒì„¸

### 2.1 Phase 1-1: ë°ì´í„° ëª¨ë¸ ì •ì˜

**íŒŒì¼**: `csa/models/impact.py`

**êµ¬í˜„ëœ ëª¨ë¸**:
1. **ImpactNode**: ì˜í–¥ë„ ë¶„ì„ ë…¸ë“œ (í´ë˜ìŠ¤, ë©”ì„œë“œ, SQL ì •ë³´)
2. **ImpactSummary**: ì˜í–¥ë„ ë¶„ì„ ìš”ì•½ í†µê³„
3. **PackageSummary**: íŒ¨í‚¤ì§€ë³„ í†µê³„
4. **SqlDetail**: SQL ìƒì„¸ ì •ë³´
5. **TestScopeItem**: í…ŒìŠ¤íŠ¸ ë²”ìœ„ í•­ëª©
6. **ImpactAnalysisResult**: ì˜í–¥ë„ ë¶„ì„ ìµœì¢… ê²°ê³¼

**í•µì‹¬ í•„ë“œ**:
- `level`: ì˜í–¥ë„ ë ˆë²¨ (1: ì§ì ‘, 2+: ê°„ì ‘)
- `depth`: í˜¸ì¶œ ê¹Šì´ (0: ì§ì ‘ í˜¸ì¶œ)
- `risk_grade`: ë¦¬ìŠ¤í¬ ë“±ê¸‰ (HIGH/MEDIUM/LOW)
- `impact_tree`: Levelë³„ ë…¸ë“œ ëª©ë¡ (ê³„ì¸µ êµ¬ì¡°)
- `has_circular_reference`: ìˆœí™˜ ì°¸ì¡° ì—¬ë¶€

### 2.2 Phase 1-2: ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„ ë¡œì§

**íŒŒì¼**: `csa/services/db_call_analysis/reverse_impact.py`

**êµ¬í˜„ëœ í´ë˜ìŠ¤**: `ReverseImpactMixin`

**í•µì‹¬ ë©”ì„œë“œ**:

#### 1. `analyze_table_impact_reverse()`
í…Œì´ë¸” ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„:
- **ì…ë ¥**: í…Œì´ë¸”ëª…, í”„ë¡œì íŠ¸ëª…(ì„ íƒ), ìµœëŒ€ ê¹Šì´
- **ì²˜ë¦¬ íë¦„**:
  1. SqlStatement ë…¸ë“œì—ì„œ í…Œì´ë¸” ì‚¬ìš© SQL ì¡°íšŒ
  2. SQLì„ í˜¸ì¶œí•˜ëŠ” Method ì¡°íšŒ
  3. Methodë¥¼ í˜¸ì¶œí•˜ëŠ” ìƒìœ„ Method ì¬ê·€ ì¡°íšŒ (ìµœëŒ€ 10 depth)
  4. ì˜í–¥ë„ íŠ¸ë¦¬ êµ¬ì¶• (Levelë³„ ê·¸ë£¹í•‘)
  5. ë¦¬ìŠ¤í¬ ë“±ê¸‰ ê³„ì‚°
  6. í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìë™ ì‹ë³„
  7. ìˆœí™˜ ì°¸ì¡° íƒì§€

**Neo4j ì¿¼ë¦¬ íŠ¹ì§•**:
```cypher
// project_nameì´ NULLì¼ ê²½ìš° ì „ì²´ í”„ë¡œì íŠ¸ ëŒ€ìƒ ë¶„ì„
WHERE ($project_name IS NULL OR sql.project_name = $project_name)

// ì—­ë°©í–¥ í˜¸ì¶œ ì²´ì¸ íƒìƒ‰
OPTIONAL MATCH path = (caller:Method)-[:CALLS*1..10]->(m)
WHERE length(path) <= $max_depth
```

#### 2. `analyze_method_impact_reverse()`
ë©”ì„œë“œ ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„:
- **ì…ë ¥**: í´ë˜ìŠ¤ëª…, ë©”ì„œë“œëª…(ì„ íƒ), í”„ë¡œì íŠ¸ëª…(ì„ íƒ), ìµœëŒ€ ê¹Šì´
- **ì²˜ë¦¬ íë¦„**:
  1. ëŒ€ìƒ Method ë…¸ë“œ ì¡°íšŒ
  2. í•´ë‹¹ Methodë¥¼ í˜¸ì¶œí•˜ëŠ” ëª¨ë“  ìƒìœ„ Method ì¬ê·€ ì¡°íšŒ
  3. ì˜í–¥ë„ íŠ¸ë¦¬ êµ¬ì¶•
  4. í†µê³„ ë° ë¦¬ìŠ¤í¬ ê³„ì‚°

#### 3. `_calculate_risk_grade()`
ë¦¬ìŠ¤í¬ ë“±ê¸‰ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜:
```python
risk_score = (
    SQL_ë³µì¡ë„_ì ìˆ˜ * 0.3 +    # SQL complexity > 10: 30ì 
    í˜¸ì¶œ_ê¹Šì´_ì ìˆ˜ * 0.2 +      # depth >= 5: 20ì 
    ì˜í–¥_ë²”ìœ„_ì ìˆ˜ * 0.4 +      # ë…¸ë“œ ìˆ˜ > 50: 40ì 
    SQL_íƒ€ì…_ì ìˆ˜ * 0.1         # UPDATE/DELETE: 10ì 
)

# ë¦¬ìŠ¤í¬ ë“±ê¸‰
if risk_score >= 70: return "HIGH"
elif risk_score >= 40: return "MEDIUM"
else: return "LOW"
```

#### 4. `_identify_test_scope()`
í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìë™ ì‹ë³„ (ë„¤ì´ë° ì»¨ë²¤ì…˜ ê¸°ë°˜):
- `{ClassName}Test`
- `{ClassName}Tests`
- `Test{ClassName}`

#### 5. `_detect_circular_references()`
ìˆœí™˜ ì°¸ì¡° íƒì§€:
```cypher
MATCH path = (m)-[:CALLS*2..10]->(m)  // ìê¸° ìì‹ ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” ê²½ë¡œ
```

### 2.3 Phase 1-3: CLI ëª…ë ¹ì–´ ì¶”ê°€

**íŒŒì¼**: `csa/cli/commands/impact.py`

**ëª…ë ¹ì–´**: `impact-analysis`

**ì˜µì…˜**:
- `--table-name`: í…Œì´ë¸”ëª… (í…Œì´ë¸” ë¶„ì„ìš©)
- `--class-name`: í´ë˜ìŠ¤ëª… (ë©”ì„œë“œ ë¶„ì„ìš©)
- `--method-name`: ë©”ì„œë“œëª… (ì„ íƒì‚¬í•­)
- `--project-name`: í”„ë¡œì íŠ¸ëª… (ì„ íƒì‚¬í•­)
- `--max-depth`: ìµœëŒ€ í˜¸ì¶œ ê¹Šì´ (ê¸°ë³¸ê°’: 10)
- `--include-json`: JSON íŒŒì¼ ì¶”ê°€ ìƒì„± (ê¸°ë³¸ê°’: False)
- `--output-dir`: ì¶œë ¥ ë””ë ‰í„°ë¦¬

**ì˜µì…˜ ê²€ì¦ ë¡œì§**:
- `--table-name`ê³¼ `--class-name`ì€ ë°°íƒ€ì  (ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì§€ì •)
- `--project-name`ì€ ì„ íƒì‚¬í•­ (ìƒëµ ì‹œ ì „ì²´ í”„ë¡œì íŠ¸ ëŒ€ìƒ)

**main.py ë“±ë¡**:
```python
from csa.cli.commands.impact import register as register_impact
register_impact(cli)
```

### 2.4 Phase 2: ë¦¬í¬íŠ¸ ìƒì„±ê¸° êµ¬í˜„

**íŒŒì¼**: `csa/services/db_call_analysis/impact_reporter.py`

**êµ¬í˜„ëœ í´ë˜ìŠ¤**: `ImpactReporter`

#### 2.4.1 Markdown ë¦¬í¬íŠ¸ (`generate_markdown()`)

**êµ¬ì¡°**:
1. **ë¶„ì„ ê°œìš”**: ë¶„ì„ ëŒ€ìƒ, í”„ë¡œì íŠ¸, ë¶„ì„ ìœ í˜•, ì¼ì‹œ
2. **ì˜í–¥ë„ ìš”ì•½**: ì´ ì˜í–¥ ë²”ìœ„, ì˜í–¥ ê¹Šì´, ë¦¬ìŠ¤í¬ ë“±ê¸‰
3. **ì˜í–¥ë„ íŠ¸ë¦¬** (Levelë³„):
   - Level 1: ì§ì ‘ ì˜í–¥ (Depth 0)
   - Level 2+: ê°„ì ‘ ì˜í–¥ (Depth N)
   - ê° ë…¸ë“œì— ë¦¬ìŠ¤í¬ ì•„ì´ì½˜ í‘œì‹œ (ğŸ”´ HIGH, ğŸŸ¡ MEDIUM, ğŸŸ¢ LOW)
4. **íŒ¨í‚¤ì§€ë³„ í†µê³„**: í…Œì´ë¸” í˜•ì‹
5. **SQL ìƒì„¸ ì •ë³´**: í…Œì´ë¸” í˜•ì‹ (í…Œì´ë¸” ë¶„ì„ ì‹œ)
6. **ê¶Œì¥ í…ŒìŠ¤íŠ¸ ë²”ìœ„**:
   - ê¸°ì¡´ í…ŒìŠ¤íŠ¸ (ì‹¤í–‰ ê¶Œì¥)
   - í…ŒìŠ¤íŠ¸ ë¯¸ì¡´ì¬ (ì‘ì„± ê¶Œì¥)
   - í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ê³„ì‚°
7. **ë³€ê²½ ì‹œ ì£¼ì˜ì‚¬í•­**: ìˆœí™˜ ì°¸ì¡°, High Risk ë©”ì„œë“œ

**ìƒ˜í”Œ ì¶œë ¥**:
```markdown
# ì˜í–¥ë„ ë¶„ì„ ë³´ê³ ì„œ

## 1. ë¶„ì„ ê°œìš”
- **ë¶„ì„ ëŒ€ìƒ**: `USER`
- **í”„ë¡œì íŠ¸**: ì „ì²´
- **ë¶„ì„ ìœ í˜•**: table
- **ë¶„ì„ ì¼ì‹œ**: 20251021-143000

## 2. ì˜í–¥ë„ ìš”ì•½
- **ì´ ì˜í–¥ ë²”ìœ„**:
  - ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤: 15ê°œ
  - ì˜í–¥ë°›ëŠ” ë©”ì„œë“œ: 45ê°œ
  - ì˜í–¥ë°›ëŠ” íŒ¨í‚¤ì§€: 5ê°œ
- **ì˜í–¥ ê¹Šì´**:
  - ìµœëŒ€ í˜¸ì¶œ ê¹Šì´: 5
  - í‰ê·  í˜¸ì¶œ ê¹Šì´: 2.8
- **ë¦¬ìŠ¤í¬ ë“±ê¸‰**: **HIGH** âš ï¸
  - High: 8ê°œ ë©”ì„œë“œ
  - Medium: 12ê°œ ë©”ì„œë“œ
  - Low: 25ê°œ ë©”ì„œë“œ
```

#### 2.4.2 Excel ë¦¬í¬íŠ¸ (`generate_excel()`)

**ì‹œíŠ¸ êµ¬ì„±**:

**1. Summary ì‹œíŠ¸**:
- ë¶„ì„ ëŒ€ìƒ, í”„ë¡œì íŠ¸, ë¶„ì„ ìœ í˜•, ë¶„ì„ ì¼ì‹œ
- ì´ ì˜í–¥ ë²”ìœ„ (í´ë˜ìŠ¤, ë©”ì„œë“œ, íŒ¨í‚¤ì§€ ìˆ˜)
- ìµœëŒ€/í‰ê·  í˜¸ì¶œ ê¹Šì´
- ë¦¬ìŠ¤í¬ ë¶„í¬ (HIGH/MEDIUM/LOW)
- ìˆœí™˜ ì°¸ì¡° ì—¬ë¶€

**2. Impact Detail ì‹œíŠ¸**:
| Level | Depth | Package | Class | Method | SQL Type | Complexity | Risk | ë¹„ê³  |
|-------|-------|---------|-------|--------|----------|-----------|------|------|
| 1 | 0 | com.example.repository | UserMapper | selectUserById | SELECT | 3 | Low | ì§ì ‘ ì‚¬ìš© |
| 2 | 1 | com.example.service | UserService | getUser | - | 5 | Medium | 1ì°¨ í˜¸ì¶œì |

**3. Package Summary ì‹œíŠ¸**:
| Package | ì˜í–¥ í´ë˜ìŠ¤ ìˆ˜ | ì˜í–¥ ë©”ì„œë“œ ìˆ˜ | í‰ê·  Depth | High | Medium | Low |
|---------|------------|------------|-----------|------|--------|-----|
| com.example.controller | 5 | 12 | 2.5 | 3 | 2 | 7 |

**4. SQL Detail ì‹œíŠ¸** (í…Œì´ë¸” ë¶„ì„ ì‹œ):
| SQL ID | SQL Type | Mapper Class | Mapper Method | Complexity | Query Preview |
|--------|----------|--------------|--------------|-----------|---------------|
| SQL001 | SELECT | UserMapper | selectUserById | 3 | SELECT * FROM USER... |

**5. Test Scope ì‹œíŠ¸**:
| ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤ | ëŒ€ì‘ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ | í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ìˆ˜ | ìƒíƒœ |
|-------------|----------------|-------------|------|
| UserController | UserControllerTest | 5 | ì¡´ì¬ |

**ìŠ¤íƒ€ì¼ë§**:
- í—¤ë”: íŒŒë€ìƒ‰ ë°°ê²½ (#4472C4), í°ìƒ‰ ê¸€ì”¨, êµµê²Œ
- Risk ì…€: HIGH(ë¹¨ê°•), MEDIUM(ì£¼í™©), LOW(ì´ˆë¡)
- ì—´ ë„ˆë¹„: ìë™ ì¡°ì •

#### 2.4.3 JSON ë¦¬í¬íŠ¸ (`generate_json()`)

Pydantic ëª¨ë¸ì˜ `model_dump(mode="json")` ì§ë ¬í™”:
```json
{
  "project_name": "car-center-devlab",
  "analysis_type": "table",
  "target_name": "USER",
  "timestamp": "20251021-143000",
  "summary": {
    "target_type": "table",
    "target_name": "USER",
    "total_impacted_classes": 15,
    "total_impacted_methods": 45,
    ...
  },
  "impact_tree": {
    "1": [...],
    "2": [...]
  },
  ...
}
```

### 2.5 Phase 3: Mermaid ì‹œê°í™” (ì‹ ê·œ ì¶”ê°€)

**íŒŒì¼**:
- `csa/diagrams/impact/mermaid_generator.py`
- `csa/diagrams/impact/__init__.py`

**êµ¬í˜„ëœ í´ë˜ìŠ¤**: `ImpactMermaidGenerator`

#### 2.5.1 ìƒì„±ë˜ëŠ” ë‹¤ì´ì–´ê·¸ë¨

**1. í˜¸ì¶œ ì²´ì¸ íŠ¸ë¦¬ (graph TD)**

Mermaid graph TD í˜•ì‹ìœ¼ë¡œ í˜¸ì¶œ ì²´ì¸ì„ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ì‹œê°í™”:
```mermaid
graph TD
    ROOT["USER"]
    N0["UserMapper\nselectUserById\n(SELECT)"]
    N1["UserService\ngetUser"]
    N2["UserController\ngetUserInfo"]

    ROOT --> N0
    N0 --> N1
    N1 --> N2

    style ROOT fill:#e1f5ff,stroke:#01579b,stroke-width:3px
    style N0 fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px
    style N1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style N2 fill:#ffcdd2,stroke:#c62828,stroke-width:2px
```

**ìƒ‰ìƒ ì½”ë“œ**:
- ğŸ”µ **ë£¨íŠ¸ ë…¸ë“œ** (ë¶„ì„ ëŒ€ìƒ): íŒŒë€ìƒ‰ (`#e1f5ff`)
- ğŸŸ¢ **LOW ë¦¬ìŠ¤í¬**: ì´ˆë¡ìƒ‰ (`#c8e6c9`)
- ğŸŸ¡ **MEDIUM ë¦¬ìŠ¤í¬**: ë…¸ë€ìƒ‰ (`#fff9c4`)
- ğŸ”´ **HIGH ë¦¬ìŠ¤í¬**: ë¹¨ê°„ìƒ‰ (`#ffcdd2`)

**2. ë¦¬ìŠ¤í¬ ë¶„í¬ íŒŒì´ ì°¨íŠ¸ (pie)**

```mermaid
pie title ë¦¬ìŠ¤í¬ ë“±ê¸‰ ë¶„í¬
    "HIGH" : 8
    "MEDIUM" : 12
    "LOW" : 25
```

**3. íŒ¨í‚¤ì§€ë³„ ì˜í–¥ë„ (graph LR)**

```mermaid
graph LR
    PKG0["controller\në©”ì„œë“œ: 12ê°œ"]
    PKG1["service\në©”ì„œë“œ: 20ê°œ"]
    PKG2["repository\në©”ì„œë“œ: 8ê°œ"]

    PKG0 --> PKG1
    PKG1 --> PKG2

    style PKG0 fill:#ffcdd2,stroke:#c62828,stroke-width:2px
    style PKG1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style PKG2 fill:#c8e6c9,stroke:#2e7d32,stroke-width:2px
```

#### 2.5.2 CLI ì˜µì…˜ ì¶”ê°€

**ìƒˆë¡œìš´ ì˜µì…˜**: `--generate-diagram`

```bash
python -m csa.cli.main impact-analysis \
  --table-name USER \
  --generate-diagram
```

**ì¶œë ¥ íŒŒì¼**:
- `IMPACT_TABLE_USER_20251021-143000_diagram.md`
- `IMPACT_METHOD_UserService_getUser_20251021-143100_diagram.md`

#### 2.5.3 ImpactReporter í†µí•©

`generate_mermaid_diagram()` ë©”ì„œë“œ ì¶”ê°€:
```python
def generate_mermaid_diagram(
    self,
    result: ImpactAnalysisResult,
    filepath: Path,
) -> bool:
    """Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±"""
    generator = ImpactMermaidGenerator()
    return generator.generate_diagram(result, filepath)
```

#### 2.5.4 í™œìš© ë°©ë²•

**GitHub/GitLabì—ì„œ ë°”ë¡œ ë Œë”ë§**:
- `.md` íŒŒì¼ì„ ì»¤ë°‹í•˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ì´ì–´ê·¸ë¨ ë Œë”ë§
- PR/MRì— ì²¨ë¶€í•˜ì—¬ ì‹œê°ì  ë¦¬ë·° ê°€ëŠ¥

**Markdown ì—ë””í„°ì—ì„œ ë¯¸ë¦¬ë³´ê¸°**:
- VS Code (Mermaid í”ŒëŸ¬ê·¸ì¸)
- Typora, Obsidian ë“±

**ì´ë¯¸ì§€ ë³€í™˜** (ì„ íƒì‚¬í•­):
- `mmdc` CLI ì‚¬ìš©í•˜ì—¬ PNG/SVG ë³€í™˜
- í”„ë ˆì  í…Œì´ì…˜/ë¬¸ì„œì— ì‚½ì…

---

## 3. íŒŒì¼ êµ¬ì¡°

### 3.1 ìƒì„±ëœ íŒŒì¼
```
csa/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ impact.py                      # âœ… ì‹ ê·œ (190 lines)
â”‚
â”œâ”€â”€ services/
â”‚   â””â”€â”€ db_call_analysis/
â”‚       â”œâ”€â”€ reverse_impact.py          # âœ… ì‹ ê·œ (650 lines)
â”‚       â””â”€â”€ impact_reporter.py         # âœ… ì‹ ê·œ (565 lines) - Mermaid ë©”ì„œë“œ ì¶”ê°€
â”‚
â”œâ”€â”€ diagrams/
â”‚   â””â”€â”€ impact/
â”‚       â”œâ”€â”€ __init__.py                # âœ… ì‹ ê·œ
â”‚       â””â”€â”€ mermaid_generator.py       # âœ… ì‹ ê·œ (280 lines)
â”‚
â”œâ”€â”€ cli/
â”‚   â”œâ”€â”€ main.py                        # âœï¸ ìˆ˜ì • (import ì¶”ê°€, register í˜¸ì¶œ)
â”‚   â””â”€â”€ commands/
â”‚       â””â”€â”€ impact.py                  # âœ… ì‹ ê·œ (280 lines) - --generate-diagram ì˜µì…˜ ì¶”ê°€
â”‚
env.example                            # âœï¸ ìˆ˜ì • (IMPACT_ANALYSIS_OUTPUT_DIR ì¶”ê°€)
```

**ì´ ë¼ì¸ ìˆ˜**: ì•½ **1,965 ë¼ì¸** ì¶”ê°€ (Phase 3 í¬í•¨)

### 3.2 ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •
- `csa/cli/main.py`: impact ëª…ë ¹ì–´ ë“±ë¡ (2ì¤„ ì¶”ê°€)
- `env.example`: IMPACT_ANALYSIS_OUTPUT_DIR í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ (1ì¤„ ì¶”ê°€)

---

## 4. ì‚¬ìš© ì˜ˆì œ

### 4.1 í…Œì´ë¸” ì˜í–¥ë„ ë¶„ì„

#### ì˜ˆì œ 1: ì „ì²´ í”„ë¡œì íŠ¸ì—ì„œ USER í…Œì´ë¸” ë¶„ì„
```bash
python -m csa.cli.main impact-analysis --table-name USER
```

**ì¶œë ¥**:
```
================================================================================
í…Œì´ë¸” ì˜í–¥ë„ ë¶„ì„: USER
í”„ë¡œì íŠ¸: ì „ì²´
ìµœëŒ€ ê¹Šì´: 10
================================================================================

[ìš”ì•½]
  ë¶„ì„ ëŒ€ìƒ: USER
  ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤: 15ê°œ
  ì˜í–¥ë°›ëŠ” ë©”ì„œë“œ: 45ê°œ
  ì˜í–¥ë°›ëŠ” íŒ¨í‚¤ì§€: 5ê°œ
  ìµœëŒ€ í˜¸ì¶œ ê¹Šì´: 5
  í‰ê·  í˜¸ì¶œ ê¹Šì´: 2.8
  ë¦¬ìŠ¤í¬ ë“±ê¸‰:
    - HIGH: 8ê°œ
    - MEDIUM: 12ê°œ
    - LOW: 25ê°œ

âœ“ Markdown ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143000.md
âœ“ Excel ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143000.xlsx

ë¶„ì„ ì™„ë£Œ!
```

#### ì˜ˆì œ 2: íŠ¹ì • í”„ë¡œì íŠ¸ì˜ í…Œì´ë¸” ë¶„ì„ (JSON í¬í•¨)
```bash
python -m csa.cli.main impact-analysis \
  --table-name USER \
  --project-name car-center-devlab \
  --include-json
```

**ì¶œë ¥**:
```
âœ“ Markdown ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143100.md
âœ“ Excel ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143100.xlsx
âœ“ JSON ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143100.json
```

### 4.2 ë©”ì„œë“œ ì˜í–¥ë„ ë¶„ì„

#### ì˜ˆì œ 3: íŠ¹ì • ë©”ì„œë“œ ë¶„ì„
```bash
python -m csa.cli.main impact-analysis \
  --class-name UserService \
  --method-name getUser \
  --project-name car-center-devlab
```

**ì¶œë ¥**:
```
================================================================================
ë©”ì„œë“œ ì˜í–¥ë„ ë¶„ì„: UserService.getUser
í”„ë¡œì íŠ¸: car-center-devlab
ìµœëŒ€ ê¹Šì´: 10
================================================================================

[ìš”ì•½]
  ë¶„ì„ ëŒ€ìƒ: UserService.getUser
  ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤: 8ê°œ
  ì˜í–¥ë°›ëŠ” ë©”ì„œë“œ: 15ê°œ
  ì˜í–¥ë°›ëŠ” íŒ¨í‚¤ì§€: 3ê°œ
  ìµœëŒ€ í˜¸ì¶œ ê¹Šì´: 3
  í‰ê·  í˜¸ì¶œ ê¹Šì´: 1.5
  ë¦¬ìŠ¤í¬ ë“±ê¸‰:
    - HIGH: 2ê°œ
    - MEDIUM: 5ê°œ
    - LOW: 8ê°œ

âœ“ Markdown ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_METHOD_UserService_getUser_20251021-143200.md
âœ“ Excel ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_METHOD_UserService_getUser_20251021-143200.xlsx
```

#### ì˜ˆì œ 4: í´ë˜ìŠ¤ì˜ ëª¨ë“  public ë©”ì„œë“œ ë¶„ì„
```bash
python -m csa.cli.main impact-analysis \
  --class-name UserService \
  --project-name car-center-devlab
```

#### ì˜ˆì œ 5: ë‹¤ì´ì–´ê·¸ë¨ í¬í•¨ ì „ì²´ ë¦¬í¬íŠ¸ ìƒì„± (Phase 3)
```bash
python -m csa.cli.main impact-analysis \
  --table-name USER \
  --project-name car-center-devlab \
  --generate-diagram \
  --include-json
```

**ì¶œë ¥**:
```
âœ“ Markdown ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143300.md
âœ“ Excel ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143300.xlsx
âœ“ JSON ë¦¬í¬íŠ¸ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143300.json
âœ“ Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±: output/impact-analysis/IMPACT_TABLE_USER_20251021-143300_diagram.md
```

---

## 5. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**env.example** (ì¶”ê°€ë¨):
```ini
IMPACT_ANALYSIS_OUTPUT_DIR=output/impact-analysis
```

**ì‹¤ì œ .env íŒŒì¼ì— ì¶”ê°€** (ì‚¬ìš©ì ì‘ì—… í•„ìš”):
```ini
IMPACT_ANALYSIS_OUTPUT_DIR=output/impact-analysis
```

---

## 6. ì¶œë ¥ íŒŒì¼ í˜•ì‹

### 6.1 íŒŒì¼ëª… ê·œì¹™

**í…Œì´ë¸” ì˜í–¥ë„**:
- Markdown: `IMPACT_TABLE_{Table}_{YYYYMMDD-HHmmSS}.md`
- Excel: `IMPACT_TABLE_{Table}_{YYYYMMDD-HHmmSS}.xlsx`
- JSON: `IMPACT_TABLE_{Table}_{YYYYMMDD-HHmmSS}.json` (--include-json í”Œë˜ê·¸ ì‹œ)
- **Mermaid ë‹¤ì´ì–´ê·¸ë¨**: `IMPACT_TABLE_{Table}_{YYYYMMDD-HHmmSS}_diagram.md` (--generate-diagram í”Œë˜ê·¸ ì‹œ)

**ë©”ì„œë“œ ì˜í–¥ë„**:
- Markdown: `IMPACT_METHOD_{Class}_{Method}_{YYYYMMDD-HHmmSS}.md`
- Excel: `IMPACT_METHOD_{Class}_{Method}_{YYYYMMDD-HHmmSS}.xlsx`
- JSON: `IMPACT_METHOD_{Class}_{Method}_{YYYYMMDD-HHmmSS}.json` (--include-json í”Œë˜ê·¸ ì‹œ)
- **Mermaid ë‹¤ì´ì–´ê·¸ë¨**: `IMPACT_METHOD_{Class}_{Method}_{YYYYMMDD-HHmmSS}_diagram.md` (--generate-diagram í”Œë˜ê·¸ ì‹œ)

**ì¶œë ¥ í˜•ì‹**:
- **ê¸°ë³¸ ì¶œë ¥**: Markdown + Excel (í•­ìƒ ìƒì„±)
- **ì„ íƒ ì¶œë ¥**:
  - JSON (--include-json í”Œë˜ê·¸)
  - Mermaid ë‹¤ì´ì–´ê·¸ë¨ (--generate-diagram í”Œë˜ê·¸)

---

## 7. í•µì‹¬ ê¸°ëŠ¥ ìš”ì•½

### 7.1 êµ¬í˜„ëœ ì£¼ìš” ê¸°ëŠ¥

1. âœ… **í…Œì´ë¸” ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„**
   - Table â†’ SQL â†’ Mapper â†’ Method â†’ Caller Methods
   - í”„ë¡œì íŠ¸ í•„í„°ë§ (ì„ íƒì‚¬í•­)
   - ìµœëŒ€ 10 depth ì¬ê·€ ì¡°íšŒ

2. âœ… **ë©”ì„œë“œ ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„**
   - Method â†’ Caller Methods (ì¬ê·€)
   - í´ë˜ìŠ¤ì˜ ëª¨ë“  public ë©”ì„œë“œ ì¼ê´„ ë¶„ì„ ì§€ì›

3. âœ… **ë¦¬ìŠ¤í¬ ë“±ê¸‰ ê³„ì‚°**
   - SQL ë³µì¡ë„, í˜¸ì¶œ ê¹Šì´, ì˜í–¥ ë²”ìœ„, SQL íƒ€ì… ê¸°ë°˜
   - HIGH/MEDIUM/LOW ìë™ ë¶„ë¥˜

4. âœ… **í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìë™ ì‹ë³„**
   - ë„¤ì´ë° ì»¨ë²¤ì…˜ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ë§¤í•‘
   - í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ê³„ì‚°

5. âœ… **ìˆœí™˜ ì°¸ì¡° íƒì§€**
   - ìê¸° ìì‹ ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” í˜¸ì¶œ ê²½ë¡œ íƒì§€
   - ìˆœí™˜ ê²½ë¡œ ëª©ë¡ ì œê³µ

6. âœ… **ë‹¤ì¤‘ ë¦¬í¬íŠ¸ í˜•ì‹**
   - Markdown (ê°€ë…ì„± ìš°ìˆ˜)
   - Excel (êµ­ë‚´ SI í‘œì¤€ ì–‘ì‹, 5ê°œ ì‹œíŠ¸)
   - JSON (í”„ë¡œê·¸ë˜ë° ì—°ë™ìš©)
   - **Mermaid ë‹¤ì´ì–´ê·¸ë¨** (ì‹œê°í™”)

7. âœ… **Mermaid ì‹œê°í™”** (Phase 3)
   - í˜¸ì¶œ ì²´ì¸ íŠ¸ë¦¬ (graph TD)
   - ë¦¬ìŠ¤í¬ ë¶„í¬ íŒŒì´ ì°¨íŠ¸ (pie)
   - íŒ¨í‚¤ì§€ë³„ ì˜í–¥ë„ (graph LR)

### 7.2 ê³„íšì„œ ëŒ€ë¹„ êµ¬í˜„ í˜„í™©

| í•­ëª© | ê³„íš | êµ¬í˜„ | ìƒíƒœ |
|------|------|------|------|
| Phase 1-1: ë°ì´í„° ëª¨ë¸ | 6ê°œ ëª¨ë¸ | 6ê°œ ëª¨ë¸ | âœ… ì™„ë£Œ |
| Phase 1-2: ì—­ë°©í–¥ ë¶„ì„ ë¡œì§ | í…Œì´ë¸”/ë©”ì„œë“œ ë¶„ì„ | í…Œì´ë¸”/ë©”ì„œë“œ ë¶„ì„ | âœ… ì™„ë£Œ |
| Phase 1-3: CLI ëª…ë ¹ì–´ | impact-analysis | impact-analysis | âœ… ì™„ë£Œ |
| Phase 2-1: Markdown ë¦¬í¬íŠ¸ | 7ê°œ ì„¹ì…˜ | 7ê°œ ì„¹ì…˜ | âœ… ì™„ë£Œ |
| Phase 2-2: Excel ë¦¬í¬íŠ¸ | 5ê°œ ì‹œíŠ¸ | 5ê°œ ì‹œíŠ¸ | âœ… ì™„ë£Œ |
| Phase 2-3: JSON ë¦¬í¬íŠ¸ | Pydantic ì§ë ¬í™” | Pydantic ì§ë ¬í™” | âœ… ì™„ë£Œ |
| **Phase 3: ê³ ê¸‰ ê¸°ëŠ¥** | **ì„ íƒì‚¬í•­** | **ì™„ì „ êµ¬í˜„** | âœ… **ì™„ë£Œ** |
| Phase 4: í…ŒìŠ¤íŠ¸ | ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ | ë¯¸êµ¬í˜„ | âŒ ë¯¸ì™„ë£Œ |

**Phase 3 êµ¬í˜„ í˜„í™©** (2025-10-21 ì—…ë°ì´íŠ¸):
- âœ… í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìë™ ì‹ë³„
- âœ… ìˆœí™˜ ì°¸ì¡° íƒì§€
- âœ… **Mermaid ì‹œê°í™”** (ì‹ ê·œ êµ¬í˜„)
  - í˜¸ì¶œ ì²´ì¸ íŠ¸ë¦¬
  - ë¦¬ìŠ¤í¬ ë¶„í¬ ì°¨íŠ¸
  - íŒ¨í‚¤ì§€ë³„ ì˜í–¥ë„

---

## 8. ì œì•½ì‚¬í•­ ë° ì£¼ì˜ì‚¬í•­

### 8.1 ê¸°ìˆ ì  ì œì•½ì‚¬í•­

1. **Neo4j ì˜ì¡´ì„±**:
   - SqlStatement ë…¸ë“œì— `tables` ì†ì„± í•„ìˆ˜
   - Method ê°„ `:CALLS` ê´€ê³„ í•„ìˆ˜
   - ê¸°ì¡´ í”„ë¡œì íŠ¸ ë¶„ì„ ì™„ë£Œ ìƒíƒœ í•„ìš”

2. **ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­**:
   - ìµœëŒ€ ê¹Šì´ ì œí•œ (ê¸°ë³¸ê°’: 10)
   - ì¬ê·€ ì¿¼ë¦¬ ì‹œ ì¸ë±ìŠ¤ í™œìš© ê¶Œì¥
   - ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸(ìˆ˜ì²œ ê°œ ë©”ì„œë“œ) ì‹œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€

3. **ìˆœí™˜ ì°¸ì¡°**:
   - ë¬´í•œ ë£¨í”„ ë°©ì§€ë¥¼ ìœ„í•´ ìµœëŒ€ ê¹Šì´ ì œí•œ í•„ìˆ˜

### 8.2 ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­

1. **í”„ë¡œì íŠ¸ëª… ì˜µì…˜**:
   - í…Œì´ë¸” ë¶„ì„ ì‹œ: ì„ íƒì‚¬í•­ (ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µ ì‚¬ìš© ê°€ëŠ¥)
   - ë©”ì„œë“œ ë¶„ì„ ì‹œ: ê¶Œì¥ (í´ë˜ìŠ¤ëª… ì¤‘ë³µ ë°©ì§€)

2. **ì¶œë ¥ í˜•ì‹**:
   - Markdown + Excelì€ í•­ìƒ ìƒì„±
   - JSONì€ `--include-json` í”Œë˜ê·¸ í•„ìš”

3. **í™˜ê²½ ë³€ìˆ˜**:
   - `.env` íŒŒì¼ì— `IMPACT_ANALYSIS_OUTPUT_DIR` ì„¤ì • ê¶Œì¥

---

## 9. í–¥í›„ ê°œì„  ì‚¬í•­

### 9.1 ë¯¸êµ¬í˜„ ê¸°ëŠ¥

1. **~~ì‹œê°í™”~~** (âœ… ì™„ë£Œ):
   - ~~PlantUML íŠ¸ë¦¬ ë‹¤ì´ì–´ê·¸ë¨~~ (Mermaidë¡œ ëŒ€ì²´)
   - ~~Mermaid ê·¸ë˜í”„~~ (âœ… êµ¬í˜„ ì™„ë£Œ)
   - ~~íˆíŠ¸ë§µ (íŒ¨í‚¤ì§€ë³„ ì˜í–¥ë„)~~ (âœ… êµ¬í˜„ ì™„ë£Œ)

2. **ì¶”ê°€ ì‹œê°í™” ì˜µì…˜** (ì„ íƒì‚¬í•­):
   - PlantUML í˜•ì‹ (Mermaid ì™¸ ì¶”ê°€ ì˜µì…˜)
   - ì´ë¯¸ì§€ ìë™ ë³€í™˜ (PNG/SVG) - mmdc CLI ì—°ë™

3. **ë°°í¬ ì˜í–¥ë„**:
   - ì„œë²„/ëª¨ë“ˆë³„ ë°°í¬ ë²”ìœ„ ìë™ ì‚°ì¶œ

3. **ì•Œë¦¼ ì—°ë™**:
   - High Risk ë°œìƒ ì‹œ Slack/Email ì•Œë¦¼

4. **AI ë¶„ì„**:
   - LLM ê¸°ë°˜ ë³€ê²½ ì˜í–¥ ì˜ˆì¸¡

### 9.2 í…ŒìŠ¤íŠ¸ (Phase 4)

1. **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**:
   - `tests/unit/test_reverse_impact.py`
   - `tests/unit/test_impact_reporter.py`

2. **í†µí•© í…ŒìŠ¤íŠ¸**:
   - `tests/integration/test_impact_analysis_end_to_end.py`

3. **ì‚¬ìš©ì ë¬¸ì„œ**:
   - `docs/impact_analysis_usage.md`

---

## 10. ê²°ë¡ 

### 10.1 êµ¬í˜„ ì™„ë£Œ ì‚¬í•­

- âœ… **Phase 1**: í•µì‹¬ ê¸°ëŠ¥ ì™„ì „ êµ¬í˜„
  - ë°ì´í„° ëª¨ë¸ ì •ì˜
  - ì—­ë°©í–¥ ì˜í–¥ë„ ë¶„ì„ ë¡œì§
  - CLI ëª…ë ¹ì–´

- âœ… **Phase 2**: ë¦¬í¬íŠ¸ ìƒì„± ì™„ì „ êµ¬í˜„
  - Markdown ë¦¬í¬íŠ¸ (7ê°œ ì„¹ì…˜)
  - Excel ë¦¬í¬íŠ¸ (5ê°œ ì‹œíŠ¸)
  - JSON ë¦¬í¬íŠ¸

- âœ… **Phase 3**: ê³ ê¸‰ ê¸°ëŠ¥ **ì™„ì „ êµ¬í˜„** (2025-10-21 ì—…ë°ì´íŠ¸)
  - í…ŒìŠ¤íŠ¸ ë²”ìœ„ ìë™ ì‹ë³„
  - ìˆœí™˜ ì°¸ì¡° íƒì§€
  - **Mermaid ì‹œê°í™”** (ì‹ ê·œ ì¶”ê°€)
    - í˜¸ì¶œ ì²´ì¸ íŠ¸ë¦¬
    - ë¦¬ìŠ¤í¬ ë¶„í¬ ì°¨íŠ¸
    - íŒ¨í‚¤ì§€ë³„ ì˜í–¥ë„

- âŒ **Phase 4**: í…ŒìŠ¤íŠ¸ ë¯¸êµ¬í˜„

### 10.2 í•µì‹¬ ê°€ì¹˜

1. **ìë™í™”**: ìˆ˜ì‘ì—… ì˜í–¥ë„ ë¶„ì„ â†’ ìë™ ìƒì„± (ì‘ì—… ì‹œê°„ 90% ì ˆê°)
2. **í‘œì¤€í™”**: êµ­ë‚´ SI í‘œì¤€ ì–‘ì‹ ì¤€ìˆ˜ (ê²€í†  ì‹œê°„ ë‹¨ì¶•)
3. **ì •í™•ì„±**: Neo4j ê·¸ë˜í”„ ê¸°ë°˜ ì •í™•í•œ í˜¸ì¶œ ê´€ê³„ ì¶”ì  (ëˆ„ë½ ë°©ì§€)

### 10.3 ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€

**í˜„ì¬ ìƒíƒœ**: **í”„ë¡œë•ì…˜ ì‚¬ìš© ê°€ëŠ¥** âœ…

- âœ… Phase 1, 2, 3 **ëª¨ë‘ êµ¬í˜„ ì™„ë£Œ**
- âœ… Markdown/Excel/JSON/Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì§€ì›
- âœ… ì‹¤ë¬´ í™œìš© ê°€ëŠ¥í•œ ì™„ì„±ë„
- âœ… CLI ëª…ë ¹ì–´ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘

**í•µì‹¬ ì¥ì **:
- ğŸ“Š **ì‹œê°í™” ì§€ì›**: Mermaid ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ í•œëˆˆì— ì˜í–¥ë„ íŒŒì•…
- ğŸ“ **ë‹¤ì¤‘ í¬ë§·**: ìƒí™©ì— ë§ëŠ” ë¦¬í¬íŠ¸ í˜•ì‹ ì„ íƒ ê°€ëŠ¥
- ğŸ¯ **ì •í™•í•œ ë¶„ì„**: Neo4j ê·¸ë˜í”„ ê¸°ë°˜ ì •í™•í•œ í˜¸ì¶œ ê´€ê³„ ì¶”ì 
- ğŸ‡°ğŸ‡· **êµ­ë‚´ SI ìµœì í™”**: í‘œì¤€ Excel ì–‘ì‹ + í•œê¸€ ì§€ì›

**ê¶Œì¥ ì‚¬í•­**:
- ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ íŒŒì¼ëŸ¿ í…ŒìŠ¤íŠ¸
- ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
- GitHub/GitLabì—ì„œ Mermaid ë‹¤ì´ì–´ê·¸ë¨ í™œìš©
- Phase 4 í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± (ì•ˆì •ì„± ê°•í™”)

---

## 11. ì°¸ê³  ìë£Œ

- **ê³„íšì„œ**: `docs/ì˜í–¥ë„ë¶„ì„ê¸°ëŠ¥ì¶”ê°€_ê³„íš(20251020).md`
- **ì½”ë“œ ìœ„ì¹˜**:
  - `csa/models/impact.py` - ë°ì´í„° ëª¨ë¸
  - `csa/services/db_call_analysis/reverse_impact.py` - ì—­ë°©í–¥ ë¶„ì„ ë¡œì§
  - `csa/services/db_call_analysis/impact_reporter.py` - ë¦¬í¬íŠ¸ ìƒì„±ê¸°
  - `csa/diagrams/impact/mermaid_generator.py` - Mermaid ì‹œê°í™” (Phase 3)
  - `csa/cli/commands/impact.py` - CLI ëª…ë ¹ì–´

---

---

## 12. ë²„ê·¸ ìˆ˜ì • ì´ë ¥

### 2025-10-21: í…Œì´ë¸” ì˜í–¥ë„ ë¶„ì„ ê²°ê³¼ ëˆ„ë½ ë²„ê·¸ ìˆ˜ì •

**ë¬¸ì œ**:
- `users` í…Œì´ë¸”ì´ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ë° ì˜í–¥ë„ ë¶„ì„ ê²°ê³¼ê°€ ë¹„ì–´ìˆìŒ
- ëª¨ë“  í…Œì´ë¸”ì—ì„œ ë™ì¼í•œ í˜„ìƒ ë°œìƒ

**ì›ì¸**:
- Neo4jì˜ `SqlStatement.tables` ì†ì„±ì´ **JSON ë¬¸ìì—´**ë¡œ ì €ì¥ë¨
  - ì˜ˆ: `"[{\"name\": \"users\", \"alias\": \"u\"}]"`
- ê¸°ì¡´ ì¿¼ë¦¬ëŠ” ë°°ì—´ ë˜ëŠ” ê°ì²´ ë°°ì—´ì„ ê°€ì •
  ```cypher
  WHERE (sql.tables CONTAINS $table_name
         OR ANY(table IN sql.tables WHERE table.name = $table_name))
  ```
- ë¬¸ìì—´ì— ëŒ€í•œ `CONTAINS`ì™€ `ANY` ì—°ì‚°ì´ ì‘ë™í•˜ì§€ ì•ŠìŒ

**í•´ê²°**:
- JSON ë¬¸ìì—´ ë‚´ì—ì„œ íŒ¨í„´ ê²€ìƒ‰ìœ¼ë¡œ ë³€ê²½
- ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ê²€ìƒ‰
  ```cypher
  WHERE sql.tables IS NOT NULL
    AND toLower(sql.tables) CONTAINS toLower('"name": "' + $table_name + '"')
  ```
- `sql.query` â†’ `sql.sql_content` ì†ì„±ëª… ìˆ˜ì •

**ìˆ˜ì • íŒŒì¼**:
- `csa/services/db_call_analysis/reverse_impact.py` (48-59ë²ˆ ë¼ì¸)

**í…ŒìŠ¤íŠ¸**:
```bash
python -m csa.cli.main impact-analysis --table-name users
```

---

## 8. ë²„ê·¸ ìˆ˜ì • ì´ë ¥ (2025-10-21)

### 8.1 ë¬¸ì œ: í…Œì´ë¸” ì˜í–¥ë„ ë¶„ì„ ê²°ê³¼ê°€ 0ê°œ ë°˜í™˜

**ì¦ìƒ**:
```bash
python -m csa.cli.main impact-analysis --table-name users
# ê²°ê³¼: ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤ 0ê°œ, ë©”ì„œë“œ 0ê°œ
```

**ê·¼ë³¸ ì›ì¸**:
1. **Database ì§€ì • ëˆ„ë½**: `_open_session()`ì—ì„œ Neo4j databaseë¥¼ ëª…ì‹œí•˜ì§€ ì•ŠìŒ
2. **Mapper í´ë˜ìŠ¤ ì‹ë³„ ì‹¤íŒ¨**: `is_mapper`, `stereotype` ì†ì„±ì´ Neo4jì— ì¡´ì¬í•˜ì§€ ì•ŠìŒ
3. **ì¸ì½”ë”© ì—ëŸ¬**: Windows ì½˜ì†”ì—ì„œ ì²´í¬ë§ˆí¬(âœ“) ë¬¸ìê°€ cp949ë¡œ ì¸ì½”ë”© ë¶ˆê°€
4. **SqlDetail ê²€ì¦ ì˜¤ë¥˜**: `mapper_class`, `mapper_method` í•„ë“œê°€ í•„ìˆ˜ í•„ë“œë¡œ ì •ì˜ë¨

### 8.2 ìˆ˜ì • ë‚´ìš©

#### 8.2.1 Database ì§€ì • ìˆ˜ì •
**íŒŒì¼**: `csa/services/db_call_analysis/base.py`
```python
# ìˆ˜ì • ì „
def __init__(self, driver: Driver):
    self.driver = driver

def _open_session(self):
    return self.driver.session()

# ìˆ˜ì • í›„
def __init__(self, driver: Driver, database: str = None):
    self.driver = driver
    self.database = database or os.getenv("NEO4J_DATABASE", "neo4j")

def _open_session(self):
    return self.driver.session(database=self.database)
```

**íŒŒì¼**: `csa/cli/commands/impact.py`
```python
# ìˆ˜ì • ì „
service = ImpactAnalysisService(driver)

# ìˆ˜ì • í›„
neo4j_database = os.getenv("NEO4J_DATABASE", "neo4j")
service = ImpactAnalysisService(driver, database=neo4j_database)
```

#### 8.2.2 Mapper í´ë˜ìŠ¤ ì‹ë³„ ë¡œì§ ìˆ˜ì •
**íŒŒì¼**: `csa/services/db_call_analysis/reverse_impact.py` (77-84ë²ˆ ë¼ì¸)
```cypher
# ìˆ˜ì • ì „ (ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì†ì„± ì‚¬ìš©)
WHERE mapper_method.name = sql.id
  AND (mapper_class.is_mapper = true
       OR mapper_class.stereotype = 'mapper'
       OR 'Mapper' IN labels(mapper_class))

# ìˆ˜ì • í›„ (í´ë˜ìŠ¤ëª…/íŒ¨í‚¤ì§€ëª… íŒ¨í„´ ì‚¬ìš©)
WHERE mapper_method.name = sql.id
  AND (mapper_class.name CONTAINS 'Repository'
       OR mapper_class.name CONTAINS 'Mapper'
       OR mapper_class.package_name CONTAINS 'repository'
       OR mapper_class.package_name CONTAINS 'mapper')
```

#### 8.2.3 ì¸ì½”ë”© ì—ëŸ¬ ìˆ˜ì •
**íŒŒì¼**: `csa/cli/commands/impact.py` (203, 212, 222, 232ë²ˆ ë¼ì¸)
```python
# ìˆ˜ì • ì „
click.echo(f"âœ“ Markdown ë¦¬í¬íŠ¸ ìƒì„±: {md_filepath}")

# ìˆ˜ì • í›„
click.echo(f"[OK] Markdown ë¦¬í¬íŠ¸ ìƒì„±: {md_filepath}")
```

#### 8.2.4 SqlDetail ëª¨ë¸ ìˆ˜ì •
**íŒŒì¼**: `csa/models/impact.py` (79-80ë²ˆ ë¼ì¸)
```python
# ìˆ˜ì • ì „
mapper_class: str = Field(description="ë§¤í¼ í´ë˜ìŠ¤ëª…")
mapper_method: str = Field(description="ë§¤í¼ ë©”ì„œë“œëª…")

# ìˆ˜ì • í›„
mapper_class: Optional[str] = Field(default=None, description="ë§¤í¼ í´ë˜ìŠ¤ëª…")
mapper_method: Optional[str] = Field(default=None, description="ë§¤í¼ ë©”ì„œë“œëª…")
```

### 8.3 ìˆ˜ì • ê²°ê³¼

#### users í…Œì´ë¸” ë¶„ì„ ê²°ê³¼
```
ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤: 34ê°œ
ì˜í–¥ë°›ëŠ” ë©”ì„œë“œ: 118ê°œ
ì˜í–¥ë°›ëŠ” íŒ¨í‚¤ì§€: 19ê°œ
ìµœëŒ€ í˜¸ì¶œ ê¹Šì´: 4
í‰ê·  í˜¸ì¶œ ê¹Šì´: 1.31
ë¦¬ìŠ¤í¬: HIGH 18ê°œ, MEDIUM 118ê°œ
```

#### reservations í…Œì´ë¸” ë¶„ì„ ê²°ê³¼
```
ì˜í–¥ë°›ëŠ” í´ë˜ìŠ¤: 36ê°œ
ì˜í–¥ë°›ëŠ” ë©”ì„œë“œ: 131ê°œ
ì˜í–¥ë°›ëŠ” íŒ¨í‚¤ì§€: 19ê°œ
ìµœëŒ€ í˜¸ì¶œ ê¹Šì´: 4
í‰ê·  í˜¸ì¶œ ê¹Šì´: 1.28
ë¦¬ìŠ¤í¬: HIGH 18ê°œ, MEDIUM 134ê°œ
```

---

**ì‘ì„±ì**: CSA ê°œë°œíŒ€
**ìµœì´ˆ ì‘ì„±**: 2025-10-21
**ìµœì¢… ìˆ˜ì •**: 2025-10-21 23:40 (Phase 3 ì™„ë£Œ, ë²„ê·¸ ìˆ˜ì • ì™„ë£Œ)
